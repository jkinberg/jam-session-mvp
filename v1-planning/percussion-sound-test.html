<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Percussion Sound Test</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a2e;
            color: white;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
        }
        .sound-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }
        .sound-btn {
            background: #2d2d44;
            border: none;
            border-radius: 12px;
            padding: 30px 20px;
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.15s ease;
        }
        .sound-btn:hover {
            transform: scale(1.02);
        }
        .sound-btn:active {
            transform: scale(0.98);
        }
        .sound-btn.cowbell { background: #f59e0b; }
        .sound-btn.tambourine { background: #10b981; }
        .sound-btn.shaker { background: #6366f1; }
        .sound-btn.conga { background: #f43f5e; }

        .sound-btn .emoji {
            font-size: 32px;
            display: block;
            margin-bottom: 8px;
        }

        .params {
            background: #2d2d44;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .params h3 {
            margin-top: 0;
            color: #888;
            font-size: 14px;
            text-transform: uppercase;
        }
        .param-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .param-row label {
            width: 120px;
            font-size: 14px;
        }
        .param-row input {
            flex: 1;
        }
        .param-row span {
            width: 60px;
            text-align: right;
            font-family: monospace;
            font-size: 14px;
        }

        .start-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: #4f46e5;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 20px;
        }
        .start-btn:hover {
            background: #4338ca;
        }

        .note {
            background: #2d2d44;
            border-radius: 8px;
            padding: 15px;
            font-size: 14px;
            color: #888;
        }
        .note code {
            background: #1a1a2e;
            padding: 2px 6px;
            border-radius: 4px;
            color: #10b981;
        }
    </style>
</head>
<body>
    <h1>Latin Percussion Sounds</h1>
    <p class="subtitle">V1 Sequencer Sound Preview</p>

    <button class="start-btn" id="startBtn">Click to Enable Audio</button>

    <div class="sound-grid">
        <button class="sound-btn cowbell" data-sound="cowbell">
            <span class="emoji">üîî</span>
            Cowbell
        </button>
        <button class="sound-btn tambourine" data-sound="tambourine">
            <span class="emoji">üéä</span>
            Tambourine
        </button>
        <button class="sound-btn shaker" data-sound="shaker">
            <span class="emoji">üéµ</span>
            Shaker
        </button>
        <button class="sound-btn conga" data-sound="conga">
            <span class="emoji">ü•Å</span>
            Conga
        </button>
    </div>

    <div class="params">
        <h3>Cowbell Parameters</h3>
        <div class="param-row">
            <label>Frequency</label>
            <input type="range" id="cowbell-freq" min="400" max="1200" value="800">
            <span id="cowbell-freq-val">800</span>
        </div>
        <div class="param-row">
            <label>Harmonicity</label>
            <input type="range" id="cowbell-harm" min="1" max="10" value="5" step="0.5">
            <span id="cowbell-harm-val">5</span>
        </div>
    </div>

    <div class="params">
        <h3>Conga Parameters</h3>
        <div class="param-row">
            <label>Pitch Decay</label>
            <input type="range" id="conga-decay" min="0.01" max="0.2" value="0.08" step="0.01">
            <span id="conga-decay-val">0.08</span>
        </div>
        <div class="param-row">
            <label>Octaves</label>
            <input type="range" id="conga-octaves" min="2" max="8" value="5">
            <span id="conga-octaves-val">5</span>
        </div>
    </div>

    <div class="note">
        <strong>How to use:</strong> Click "Enable Audio" first, then tap the sound buttons.
        Adjust sliders to tweak the synth parameters. Once you find settings you like,
        the values can be copied into <code>host.template.html</code>.
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script>
        let audioStarted = false;
        let synths = {};

        // Synth definitions (tweak these!)
        function createSynths() {
            synths = {
                cowbell: new Tone.MetalSynth({
                    frequency: parseFloat(document.getElementById('cowbell-freq').value),
                    harmonicity: parseFloat(document.getElementById('cowbell-harm').value),
                    modulationIndex: 32,
                    resonance: 4000,
                    envelope: {
                        attack: 0.001,
                        decay: 0.1,
                        release: 0.05
                    }
                }).toDestination(),

                tambourine: new Tone.NoiseSynth({
                    noise: { type: 'white' },
                    envelope: {
                        attack: 0.001,
                        decay: 0.15,
                        sustain: 0,
                        release: 0.05
                    }
                }).toDestination(),

                shaker: new Tone.NoiseSynth({
                    noise: { type: 'pink' },
                    envelope: {
                        attack: 0.005,
                        decay: 0.1,
                        sustain: 0,
                        release: 0.05
                    }
                }).toDestination(),

                conga: new Tone.MembraneSynth({
                    pitchDecay: parseFloat(document.getElementById('conga-decay').value),
                    octaves: parseFloat(document.getElementById('conga-octaves').value),
                    envelope: {
                        attack: 0.001,
                        decay: 0.4,
                        sustain: 0,
                        release: 0.1
                    }
                }).toDestination()
            };

            // Adjust volumes
            synths.cowbell.volume.value = -6;
            synths.tambourine.volume.value = -10;
            synths.shaker.volume.value = -12;
            synths.conga.volume.value = -3;
        }

        // Start audio
        document.getElementById('startBtn').addEventListener('click', async () => {
            await Tone.start();
            createSynths();
            audioStarted = true;
            document.getElementById('startBtn').textContent = 'Audio Enabled ‚úì';
            document.getElementById('startBtn').style.background = '#10b981';
        });

        // Sound buttons
        document.querySelectorAll('.sound-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                if (!audioStarted) {
                    alert('Click "Enable Audio" first!');
                    return;
                }

                const sound = btn.dataset.sound;

                if (sound === 'cowbell') {
                    synths.cowbell.triggerAttackRelease('C6', '16n');
                } else if (sound === 'tambourine') {
                    synths.tambourine.triggerAttackRelease('16n');
                } else if (sound === 'shaker') {
                    synths.shaker.triggerAttackRelease('16n');
                } else if (sound === 'conga') {
                    synths.conga.triggerAttackRelease('C3', '8n');
                }
            });
        });

        // Parameter sliders
        function setupSlider(id, callback) {
            const slider = document.getElementById(id);
            const valSpan = document.getElementById(id + '-val');
            slider.addEventListener('input', () => {
                valSpan.textContent = slider.value;
                if (audioStarted) {
                    callback(parseFloat(slider.value));
                }
            });
        }

        setupSlider('cowbell-freq', (val) => {
            synths.cowbell.frequency.value = val;
        });
        setupSlider('cowbell-harm', (val) => {
            synths.cowbell.harmonicity = val;
        });
        setupSlider('conga-decay', (val) => {
            synths.conga.pitchDecay = val;
        });
        setupSlider('conga-octaves', (val) => {
            synths.conga.octaves = val;
        });
    </script>
</body>
</html>
